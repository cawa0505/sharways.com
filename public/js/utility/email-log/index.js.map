{"version":3,"file":"js/utility/email-log/index.js","sources":["webpack:///resources/js/views/utility/email-log/index.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <div class=\"page-titles\">\r\n            <div class=\"row\">\r\n                <div class=\"col-12 col-sm-6\">\r\n                    <h3 class=\"text-themecolor\">{{trans('utility.email_log')}}\r\n                        <span class=\"card-subtitle d-none d-sm-inline\" v-if=\"email_logs.total\">{{trans('general.total_result_found',{count : email_logs.total, from: email_logs.from, to: email_logs.to})}}</span>\r\n                        <span class=\"card-subtitle d-none d-sm-inline\" v-else>{{trans('general.no_result_found')}}</span>\r\n                    </h3>\r\n                </div>\r\n                <div class=\"col-12 col-sm-6\">\r\n                    <div class=\"action-buttons pull-right\">\r\n                        <sort-by :order-by-options=\"orderByOptions\" :sort-by=\"filter.sort_by\" :order=\"filter.order\" @updateSortBy=\"value => {filter.sort_by = value}\"  @updateOrder=\"value => {filter.order = value}\"></sort-by>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"container-fluid\">\r\n            <div class=\"card\">\r\n                <div class=\"card-body\">\r\n                    <div class=\"table-responsive\" v-if=\"email_logs.total\">\r\n                        <table class=\"table table-hover\">\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>{{trans('utility.email_receiver')}}</th>\r\n                                    <th>{{trans('utility.email_subject')}}</th>\r\n                                    <th>{{trans('utility.sent_at')}}</th>\r\n                                    <th class=\"table-option\">{{trans('general.action')}}</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                <tr v-for=\"email_log in email_logs.data\">\r\n                                    <td v-text=\"email_log.to_address\"></td>\r\n                                    <td v-text=\"email_log.subject\"></td>\r\n                                    <td>{{email_log.created_at | moment }}</td>\r\n                                    <td class=\"table-option\">\r\n                                        <div class=\"btn-group\">\r\n                                            <button type=\"button\" class=\"btn btn-info btn-sm\" @click=\"showDetailAction(email_log)\" v-tooltip=\"trans('utility.view_email')\"><i class=\"fas fa-arrow-circle-right\"></i></button>\r\n                                            <button class=\"btn btn-danger btn-sm\" :key=\"email_log.id\" v-confirm=\"{ok: confirmDelete(email_log)}\" v-tooltip=\"trans('utility.delete_email_log')\"><i class=\"fas fa-trash\"></i></button>\r\n                                        </div>\r\n                                    </td>\r\n                                </tr>\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                    <module-info v-if=\"!email_logs.total\" module=\"utility\" title=\"email_log_module_title\" description=\"email_log_module_description\" icon=\"list\"></module-info>\r\n                    <pagination-record :page-length.sync=\"filter.page_length\" :records=\"email_logs\" @updateRecords=\"getEmailLogs\" @change.native=\"getEmailLogs\"></pagination-record>\r\n                </div>\r\n            </div>\r\n\r\n            <transition name=\"modal\" v-if=\"showDetailModal\">\r\n                <div class=\"modal-mask\">\r\n                    <div class=\"modal-wrapper\">\r\n                        <div class=\"modal-container modal-lg\">\r\n                            <div class=\"modal-header\">\r\n                                <slot name=\"header\">\r\n                                    {{trans('utility.email_log')}}\r\n                                    <span class=\"float-right pointer\" @click=\"showDetailModal = false\">x</span>\r\n                                </slot>\r\n                            </div>\r\n                            <div class=\"modal-body\">\r\n                                <slot name=\"body\">\r\n                                    <h4>{{utility.email_subject}}\r\n                                        <span class=\"pull-right\">{{email_log.created_at | moment}}</span>\r\n                                    </h4>\r\n                                    <p>{{trans('utility.email_sender')+': '+email_log.from_address}}</p>\r\n                                    <p>{{trans('utility.email_receiver')+': '+email_log.to_address}}</p>\r\n                                    <div v-html=\"email_log.body\"></div>\r\n                                    <div class=\"clearfix\"></div>\r\n                                </slot>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </transition>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script>\r\n    export default {\r\n        components: {},\r\n        data(){\r\n            return {\r\n                email_logs: {\r\n                    total: 0,\r\n                    data: []\r\n                },\r\n                filter: {\r\n                    page_length: helper.getConfig('page_length'),\r\n                    sort_by: 'created_at',\r\n                    order: 'desc'\r\n                },\r\n                email_log: {},\r\n                orderByOptions: [\r\n                    {\r\n                        value: 'created_at',\r\n                        translation: i18n.general.created_at\r\n                    }\r\n                ],\r\n                showDetailModal: false\r\n            };\r\n        },\r\n        mounted(){\r\n            if(!helper.featureAvailable('email_log')){\r\n                helper.featureNotAvailableMsg();\r\n                this.$router.push('/dashboard');\r\n            }\r\n\r\n            if(!helper.hasPermission('access-configuration')){\r\n                helper.notAccessibleMsg();\r\n                this.$router.push('/dashboard');\r\n            }\r\n\r\n            this.getEmailLogs();\r\n        },\r\n        methods: {\r\n            getEmailLogs(page){\r\n                let loader = this.$loading.show();\r\n                if (typeof page !== 'number') {\r\n                    page = 1;\r\n                }\r\n                let url = helper.getFilterURL(this.filter);\r\n                axios.get('/api/email-log?page=' + page + url)\r\n                    .then(response => {\r\n                        this.email_logs = response;\r\n                        loader.hide();\r\n                    })\r\n                    .catch(error => {\r\n                        loader.hide();\r\n                        helper.showErrorMsg(error);\r\n                    });\r\n            },\r\n            showDetailAction(email_log){\r\n                this.showDetailModal = true;\r\n                let loader = this.$loading.show();\r\n                axios.get('/api/email-log/'+email_log.id)\r\n                    .then(response => {\r\n                        this.email_log = response;\r\n                        loader.hide();\r\n                    })\r\n                    .catch(error => {\r\n                        loader.hide();\r\n                        helper.showErrorMsg(error);\r\n                    });\r\n            },\r\n            confirmDelete(email_log){\r\n                return dialog => this.deleteEmailLog(email_log);\r\n            },\r\n            deleteEmailLog(email_log){\r\n                let loader = this.$loading.show();\r\n                axios.delete('/api/email-log/'+email_log.id)\r\n                    .then(response => {\r\n                        toastr.success(response.message);\r\n                        this.getEmailLogs();\r\n                        loader.hide();\r\n                    }).catch(error => {\r\n                        loader.hide();\r\n                        helper.showErrorMsg(error);\r\n                    });\r\n            }\r\n        },\r\n        filters: {\r\n          moment(date) {\r\n            return helper.formatDateTime(date);\r\n          }\r\n        },\r\n        watch: {\r\n            filter: {\r\n                handler(val){\r\n                    this.getEmailLogs();\r\n                },\r\n                deep: true\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\n\n\n// WEBPACK FOOTER //\n// resources/js/views/utility/email-log/index.vue"],"mappings":"AAgFA","sourceRoot":""}