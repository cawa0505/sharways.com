{"version":3,"file":"js/reception/visitor-message/index.js","sources":["webpack:///resources/js/views/reception/visitor-message/index.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <div class=\"page-titles\">\r\n            <div class=\"row\">\r\n                <div class=\"col-12 col-sm-6\">\r\n                    <h3 class=\"text-themecolor\">{{trans('reception.visitor_message')}}\r\n                        <span class=\"card-subtitle d-none d-sm-inline\" v-if=\"visitor_messages.total\">{{trans('general.total_result_found',{count : visitor_messages.total, from: visitor_messages.from, to: visitor_messages.to})}}</span>\r\n                        <span class=\"card-subtitle d-none d-sm-inline\" v-else>{{trans('general.no_result_found')}}</span>\r\n                    </h3>\r\n                </div>\r\n                <div class=\"col-12 col-sm-6\">\r\n                    <div class=\"action-buttons pull-right\">\r\n                        <button class=\"btn btn-info btn-sm\" v-if=\"!showFilterPanel\" @click=\"showFilterPanel = !showFilterPanel\"><i class=\"fas fa-filter\"></i> <span class=\"d-none d-sm-inline\">{{trans('general.filter')}}</span></button>\r\n                        <sort-by :order-by-options=\"orderByOptions\" :sort-by=\"filter.sort_by\" :order=\"filter.order\" @updateSortBy=\"value => {filter.sort_by = value}\"  @updateOrder=\"value => {filter.order = value}\"></sort-by>\r\n                        <div class=\"btn-group\">\r\n                            <button type=\"button\" class=\"btn btn-info btn-sm dropdown-toggle no-caret \" role=\"menu\" id=\"moreOption\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\" v-tooltip=\"trans('general.more_option')\">\r\n                                <i class=\"fas fa-ellipsis-h\"></i> <span class=\"d-none d-sm-inline\"></span>\r\n                            </button>\r\n                            <div :class=\"['dropdown-menu',getConfig('direction') == 'ltr' ? 'dropdown-menu-right' : '']\" aria-labelledby=\"moreOption\">\r\n                                <button class=\"dropdown-item custom-dropdown\" @click=\"print\"><i class=\"fas fa-print\"></i> {{trans('general.print')}}</button>\r\n                                <button class=\"dropdown-item custom-dropdown\" @click=\"pdf\"><i class=\"fas fa-file-pdf\"></i> {{trans('general.generate_pdf')}}</button>\r\n                            </div>\r\n                        </div>\r\n                        <help-button @clicked=\"help_topic = 'reception.visitor_message'\"></help-button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"container-fluid\">\r\n            <transition name=\"fade\">\r\n                <div class=\"card card-form\" v-if=\"showFilterPanel\">\r\n                    <div class=\"card-body\">\r\n                        <h4 class=\"card-title\">{{trans('general.filter')}}</h4>\r\n                        <div class=\"row\">\r\n                            <div class=\"col-12 col-sm-2\">\r\n                                <div class=\"form-group\">\r\n                                    <label for=\"\">{{trans('reception.visitor_message_name')}}</label>\r\n                                    <input class=\"form-control\" name=\"name\" v-model=\"filter.name\">\r\n                                </div>\r\n                            </div>\r\n                            <div class=\"col-12 col-sm-2\">\r\n                                <div class=\"form-group\">\r\n                                    <label for=\"\">{{trans('reception.visitor_message_email')}}</label>\r\n                                    <input class=\"form-control\" name=\"email\" v-model=\"filter.email\">\r\n                                </div>\r\n                            </div>\r\n                            <div class=\"col-12 col-sm-6\">\r\n                                <date-range-picker :start-date.sync=\"filter.date_start_date\" :end-date.sync=\"filter.date_end_date\" :label=\"trans('general.date_between')\"></date-range-picker>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"card-footer text-right\">\r\n                            <button type=\"button\" @click=\"showFilterPanel = false\" class=\"btn btn-danger\">{{trans('general.cancel')}}</button>\r\n                            <button type=\"button\" class=\"btn btn-info waves-effect waves-light\" @click=\"getVisitorMessages\">{{trans('general.filter')}}</button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </transition>\r\n            <div class=\"card\">\r\n                <div class=\"card-body\">\r\n                    <div class=\"table-responsive\" v-if=\"visitor_messages.total\">\r\n                        <table class=\"table table-sm\">\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>#</th>\r\n                                    <th>{{trans('reception.visitor_message_name')}}</th>\r\n                                    <th>{{trans('reception.visitor_message_contact_number')}}</th>\r\n                                    <th>{{trans('reception.visitor_message_email')}}</th>\r\n                                    <th>{{trans('reception.visitor_message_message')}}</th>\r\n                                    <th>{{trans('general.created_at')}}</th>\r\n                                    <th class=\"table-option\">{{trans('general.action')}}</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                <tr v-for=\"visitor_message in visitor_messages.data\">\r\n                                    <td v-text=\"visitor_message.id\"></td>\r\n                                    <td v-text=\"visitor_message.name\"></td>\r\n                                    <td v-text=\"visitor_message.contact_number\"></td>\r\n                                    <td v-text=\"visitor_message.email\"></td>\r\n                                    <td v-text=\"visitor_message.message\"></td>\r\n                                    <td v-text=\"visitor_message.created_at | momentDateTime\"></td>\r\n                                    <td class=\"table-option\">\r\n                                        <div class=\"btn-group\">\r\n                                            <button class=\"btn btn-danger btn-sm\" v-if=\"hasPermission('delete-visitor-message')\" :key=\"visitor_message.id\" v-confirm=\"{ok: confirmDelete(visitor_message)}\" v-tooltip=\"trans('reception.delete_visitor_message')\"><i class=\"fas fa-trash\"></i></button>\r\n                                        </div>\r\n                                    </td>\r\n                                </tr>\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                    <module-info v-if=\"!visitor_messages.total\" module=\"reception\" title=\"visitor_message_module_title\" description=\"visitor_message_module_description\" icon=\"list\">\r\n                    </module-info>\r\n                    <pagination-record :page-length.sync=\"filter.page_length\" :records=\"visitor_messages\" @updateRecords=\"getVisitorMessages\"></pagination-record>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <visitor-message-detail v-if=\"showModal\" @close=\"showModal = false\" :id=\"showId\"></visitor-message-detail>\r\n        <right-panel :topic=\"help_topic\"></right-panel>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import vSelect from 'vue-multiselect'\r\n    import datepicker from 'vuejs-datepicker'\r\n    import visitorMessageDetail from './show'\r\n\r\n    export default {\r\n        components : { datepicker,vSelect,visitorMessageDetail },\r\n        data() {\r\n            return {\r\n                visitor_messages: {\r\n                    total: 0,\r\n                    data: []\r\n                },\r\n                filter: {\r\n                    sort_by : 'created_at',\r\n                    order: 'desc',\r\n                    name: '',\r\n                    email: '',\r\n                    date_start_date: '',\r\n                    date_end_date: '',\r\n                    page_length: helper.getConfig('page_length')\r\n                },\r\n                orderByOptions: [\r\n                    {\r\n                        value: 'created_at',\r\n                        translation: i18n.general.created_at\r\n                    },\r\n                    {\r\n                        value: 'name',\r\n                        translation: i18n.reception.visitor_message_name\r\n                    }\r\n                ],\r\n                showFilterPanel: false,\r\n                showId: '',\r\n                showModal: false,\r\n                help_topic: ''\r\n            };\r\n        },\r\n        mounted(){\r\n            if(!helper.hasPermission('list-visitor-message')){\r\n                helper.notAccessibleMsg();\r\n                this.$router.push('/dashboard');\r\n            }\r\n\r\n            this.getVisitorMessages();\r\n            helper.showDemoNotification(['reception']);\r\n        },\r\n        methods: {\r\n            hasPermission(permission){\r\n                return helper.hasPermission(permission);\r\n            },\r\n            showAction(visitor_message){\r\n                this.showId = visitor_message.id;\r\n                this.showModal = true;\r\n            },\r\n            getVisitorMessages(page){\r\n                let loader = this.$loading.show();\r\n                if (typeof page !== 'number') {\r\n                    page = 1;\r\n                }\r\n                let url = helper.getFilterURL(this.filter);\r\n                axios.get('/api/visitor/message?page=' + page + url)\r\n                    .then(response => {\r\n                        this.visitor_messages = response.visitor_messages;\r\n                        loader.hide();\r\n                    })\r\n                    .catch(error => {\r\n                        loader.hide();\r\n                        helper.showErrorMsg(error);\r\n                    });\r\n            },\r\n            confirmDelete(visitor_message){\r\n                return dialog => this.deleteVisitorMessage(visitor_message);\r\n            },\r\n            deleteVisitorMessage(visitor_message){\r\n                let loader = this.$loading.show();\r\n                axios.delete('/api/visitor/message/'+visitor_message.id)\r\n                    .then(response => {\r\n                        toastr.success(response.message);\r\n                        this.getVisitorMessages();\r\n                        loader.hide();\r\n                    }).catch(error => {\r\n                        loader.hide();\r\n                        helper.showErrorMsg(error);\r\n                    });\r\n            },\r\n            getConfig(config) {\r\n                return helper.getConfig(config)\r\n            },\r\n            print(){\r\n                let loader = this.$loading.show();\r\n                axios.post('/api/visitor/message/print',{filter: this.filter})\r\n                    .then(response => {\r\n                        let print = window.open(\"/print\");\r\n                        loader.hide();\r\n                        print.document.write(response);\r\n                    })\r\n                    .catch(error => {\r\n                        loader.hide();\r\n                        helper.showErrorMsg(error);\r\n                    });\r\n            },\r\n            pdf(){\r\n                let loader = this.$loading.show();\r\n                axios.post('/api/visitor/message/pdf',{filter: this.filter})\r\n                    .then(response => {\r\n                        loader.hide();\r\n                        window.open('/download/report/'+response+'?token='+this.authToken);\r\n                    })\r\n                    .catch(error => {\r\n                        loader.hide();\r\n                        helper.showErrorMsg(error);\r\n                    });\r\n            }\r\n        },\r\n        filters: {\r\n          moment(date) {\r\n            return helper.formatDate(date);\r\n          },\r\n          momentDateTime(date) {\r\n            return helper.formatDateTime(date);\r\n          },\r\n          momentTime(time) {\r\n            return helper.formatTime(time);\r\n          }\r\n        },\r\n        watch: {\r\n            'filter.sort_by': function(val){\r\n                this.getVisitorMessages();\r\n            },\r\n            'filter.order': function(val){\r\n                this.getVisitorMessages();\r\n            },\r\n            'filter.page_length': function(val){\r\n                this.getVisitorMessages();\r\n            }\r\n        },\r\n        computed: {\r\n            authToken(){\r\n                return helper.getAuthToken();\r\n            }\r\n        }\r\n    }\r\n</script>\n\n\n// WEBPACK FOOTER //\n// resources/js/views/reception/visitor-message/index.vue"],"mappings":"AAqGA","sourceRoot":""}